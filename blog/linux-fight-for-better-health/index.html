<!DOCTYPE html>
<html lang="en-US">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="Dmitriy Shilin">
<meta name="description" content="Preface For a long time I was working in the office in the front of my lovely Dell 24 Monitor but recently I have been starting working more in front of my laptop. It is MacBook Pro 17 Late 2011, very old guy with Fedora on a board. Suddenly I started having more and more headaches. It was sad and I decided to visit a doctor. Well, we made a tons of analysis, check eyes, check vessels of the brain, check neck and a lot more and surprisingly we did not find anything.">

<meta property="og:title" content="Linux: fight for better health" />
<meta property="og:description" content="Preface For a long time I was working in the office in the front of my lovely Dell 24 Monitor but recently I have been starting working more in front of my laptop. It is MacBook Pro 17 Late 2011, very old guy with Fedora on a board. Suddenly I started having more and more headaches. It was sad and I decided to visit a doctor. Well, we made a tons of analysis, check eyes, check vessels of the brain, check neck and a lot more and surprisingly we did not find anything." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dshil.github.io/blog/linux-fight-for-better-health/" /><meta property="article:published_time" content="2019-03-15T09:53:26&#43;03:00"/>
<meta property="article:modified_time" content="2019-03-15T09:53:26&#43;03:00"/>


<title>


     Linux: fight for better health 

</title>
<link rel="canonical" href="https://dshil.github.io/blog/linux-fight-for-better-health/">







<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">




<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    
    <link rel="stylesheet" href="https://dshil.github.io/css/reset.css?t=2019-03-24%2015%3a29%3a06.954056699%20%2b0300%20MSK%20m%3d%2b0.197320329">
    <link rel="stylesheet" href="https://dshil.github.io/css/pygments.css?t=2019-03-24%2015%3a29%3a06.954056699%20%2b0300%20MSK%20m%3d%2b0.197320329">
    <link rel="stylesheet" href="https://dshil.github.io/css/main.css?t=2019-03-24%2015%3a29%3a06.954056699%20%2b0300%20MSK%20m%3d%2b0.197320329">
    




<link rel="shortcut icon"

    href="https://dshil.github.io/img/favicon.ico"

>








</head>


<body lang="en">

<section class="header">
    <div class="container">
        <div class="content">
            
                
                
                
                
                
                    
                
                
                <a href="https://dshil.github.io/"><img class="avatar" src="https://dshil.github.io/images/profile.png" srcset="https://dshil.github.io/images/profile.png 1x"></a>
            
            <a href="https://dshil.github.io/"><div class="name">Dmitriy Shilin</div></a>
            
              <h3 class="self-intro">Various notes about Software Development</h3>
            
            <nav>
                <ul>
                    
                        <li class="nav-blog"><a href="https://dshil.github.io/blog/"><span>Blog</span></a></li>
                    
                        <li class="nav-projects"><a href="https://dshil.github.io/projects/"><span>Projects</span></a></li>
                    
                        <li class="nav-talks"><a href="https://dshil.github.io/talks/"><span>Talks</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">

        
            <a href="http://github.com/dshil" target="_blank" rel="noopener"><img class="icon" src="https://dshil.github.io/img/github.svg" alt="github" /></a>
        

        

        

        

        
            <a href="https://www.linkedin.com/in/dmitriy-shilin-10032a8b" target="_blank" rel="noopener"><img class="icon" src="https://dshil.github.io/img/linkedin.svg" alt="linkedin" /></a>
        

        

        
            
        

        

        
            <a href="mailto:dshil@fastmail.com"><img class="icon" src="https://dshil.github.io/img/email.svg" alt="email" /></a>
        

        
            <a href="https://dshil.github.io/index.xml"><img class="icon" src="https://dshil.github.io/img/rss.svg" alt="rss" /></a>
        
        
        </div>
    </div>
</section>


<section class="main post non-narrow zero-top-spacing">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    Linux: fight for better health

</div>

                    <div class="initials"><a href="https://dshil.github.io/"></a></div>
                </div>
                <div class="meta">
                    
                    <div class="date" title='Fri Mar 15 2019 09:53:26 MSK'>Mar 15, 2019</div>
                    
                    
		    <div class="reading-time"><div class="middot"></div>4 minutes read</div>
                    
                </div>
            </div>
            <div class="markdown">
                

<h2 id="preface">Preface</h2>

<p>For a long time I was working in the office in the front of my lovely
Dell 24 Monitor but recently I have been starting working more in front of
my laptop. It is MacBook Pro 17 Late 2011, very old guy with Fedora on a board.
Suddenly I started having more and more headaches. It was sad and I
decided to visit a doctor. Well, we made a tons of analysis, check eyes,
check vessels of the brain, check neck and a lot more and surprisingly we did
not find anything. Doctors said that I just tired and I need to make a break
and take some medications. I did it and but it did not help. I was not able to
work in front of my laptop longer than 15-20 minutes. It was a time when the
real fight has begun.</p>

<h2 id="pulse-wave-modulation">Pulse Wave Modulation</h2>

<p>One day I found a <a href="https://www.reddit.com/r/linux4noobs/comments/2ygdpc/eyestrain_problems_while_using_linux/">post</a> on Reddit where one guy had the similar
problem that I had. From this post I got the idea that some people have
headaches because of PWM (pulse wave modulation) that controls LED backlight.
Happy owners of the intel GPU card can control this annoying PWM somehow.
Arch Linux community provides some <a href="https://wiki.archlinux.org/index.php/backlight#Troubleshooting">recommendations</a>.</p>

<p>For the first time I checked the current PWM frequency and it was 0x0:</p>

<pre><code class="language-sh">sudo intel_reg_read 0xC8254
0x0
</code></pre>

<p>From this result you can get the idea. When you decrease brightness of the
screen to the minimum level you will be under higher PWM influence. For some
people it is OK but for a little group of people, including me, it will cause
the eye stress and headaches. As a result we need to
<a href="http://devbraindom.blogspot.com/2013/03/eliminate-led-screen-flicker-with-intel.html">eliminate LED screen flicker</a> when we work in front of display with a
brightness which differs from the maximum (PWM will be eliminated automatically
for the maximum brightness). You just need to chose the desired PWM frequency:</p>

<pre><code class="language-sh">sudo intel_reg_write 0xC8254 0x3d103d1 # 1000Hz in my case
</code></pre>

<p>Of course, not all of us have the intel GPU on board. PWM usually appears on
middle or low brightness level. As a result you can set the brightness level to
the maximum and use <a href="http://jonls.dk/redshift/">redshift</a> or <a href="https://iristech.co/how-iris-reduces-pwm-flicker-medium/">iris</a> to adjust the brightness. In the
reality these tools do not change the hardware brightness, they adjust the
gamma settings instead. For some people it might work. Personally, I do not
like this approach because I have even more headaches because of mixing maximum
brightness + gamma changing.</p>

<h2 id="screen">Screen</h2>

<p>So far, so good. We fixed the PWM problem and as a result I felt much better
but some level of headaches was still there. As you remember I have a Fedora
Linux on the board with I3 tiling window manager and I did not perform any
screen and fonts adjusting after replacing the original OS X operation system.
As you might understand my fonts were no more than terrible. For development
I use <a href="http://terminus-font.sourceforge.net/">Terminus</a> and I am pretty happy with it but the remaining system looked
very awful. So, take a hammer in a hand and make own life more pleasant.</p>

<h3 id="dpi">DPI</h3>

<p>XServer usually sets some default value, e.g., 96 is frequently used. All of us
have various displays that have different resolution, hight, width parameters.
As a result we can&rsquo;t simply use the same DPI value just because it is somewhere
near our true DPI. There is a good <a href="https://askubuntu.com/questions/197828/how-to-find-and-change-the-screen-dpi">instruction</a> for DPI calculation. After doing a
short math I got the value 110 for my display parameters. After all you need to
ensure that the following commands produce the same DPI:</p>

<pre><code class="language-sh">xdpyinfo | grep dots
# resolution:    110x110 dots per inch

xrdb -query | grep dpi
# Xft.dpi:        110

grep DPI /var/log/Xorg.0.log
# [    26.888] (++) RADEON(0): DPI set to (110, 110)
# [    27.114] (++) modeset(G0): DPI set to (110, 110)
</code></pre>

<h3 id="font-rendering">Font Rendering</h3>

<p>We adjusted the DPI. From the personal view I did not see the huge difference
but probably my sensitive eyes recognized some changes. The fonts rendering was
still terrible. After a little bit of googling I found an <a href="https://wiki.manjaro.org/index.php?title=Improve_Font_Rendering">instruction</a>
for font rendering. After applying all suggested settings
the fonts rendering became very neat.</p>

<h2 id="conclusion">Conclusion</h2>

<p>You must understand your system to survive. After playing a little bit with
settings I have found some patterns that allow me to work longer in
front of my laptop without any injuries:</p>

<ul>
<li>Zero glare on the screen</li>
<li>Use low contrast themes everywhere (vim, urxvt, mutt and friends)</li>
<li>Take a break at least after 1 hour of working</li>
<li>Use 50% brightness</li>
<li>Use 100% gamma</li>
<li>Use 1000Hz PWM frequency</li>
</ul>

<p>I still have a little bit of eye stress and headaches but I think that it is
a recovery period.</p>

                <br>
		<p class="back-to-posts"><a href="https://dshil.github.io/blog/">Back to posts</a></p>
            </div>
            <br>
            <div class="disqus">
                
            </div>
            
        </div>
    </div>
</section>





  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  

  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
  </script>





</body>
</html>

